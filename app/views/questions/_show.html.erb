<style>
    .description {
        font-size: medium;
    }

</style>
<%= render "layouts/notice" %>
<% if params[:lesson_id] %>
    <%= link_to '問題一覧に戻る', lesson_questions_path(:lesson_id =>params[:lesson_id]  ),:remote => true ,:class=>"btn btn-default btn_top"  %>
<% else %>
    <%= link_to '問題一覧に戻る', questions_path, :class => "btn btn-default btn_top" %>
<% end %>

<h2><%= @question.title %></h2>

<div class="table-responsive">
  <table class="table table-bordered table-striped">
    <tr>
      <th></th>
      <th>結果</th>
      <th>実行時間(ms)</th>
      <th>メモリ使用量(MB/KB)</th>
      <th>正解数</th>
    </tr>
    <tr>
      <td>制限</td>
      <td>-</td>
      <td><%= @question.run_time_limit %> ms</td>
      <td><%= @question.memory_usage_limit %> MB</td>
      <td>-</td>
    </tr>
    <% unless @is_teacher %>
        <tr>
          <td>提出物</td>
          <% if @latest_answer.nil? %>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
          <% else %>
              <td><%= RESULT[@latest_answer.result] %></td>
              <td><%= @latest_answer.run_time.round %> ms</td>
              <td>
                <% if @latest_answer.memory_usage / 1024 == 0 %>
                <%= "#{@latest_answer.memory_usage} KB" %>
              <% else %>
                <%= "#{@latest_answer.memory_usage / 1024} MB" %>
                <% end %>
              </td>
              <td><%= "#{@latest_answer.test_passed} / #{@latest_answer.test_count}" %></td>
          <% end %>
        </tr>
    <% end %>
  </table>
  <% unless @latest_answer.nil? %>
    <% if @lesson.id != 1 %>
      <%= link_to("解答詳細", answers_lesson_question_path(:lesson_id => @lesson.id,
                                                          :question_id => @question.id),
                  :remote => ( @lesson.id != 1), class: 'btn btn-default') %>
    <% else %>
      <%= link_to("解答詳細", answers_question_path(:question_id => @question.id), class: 'btn btn-default') %>
    <% end %>
  <% end %>
</div>

<h3>説明</h3>
<div class="bg-success description">
  <%= @question.content %>
</div>
<h3>入力</h3>
<div class="bg-success description">
  <%= @question.input_description %>
</div>
<h3>出力</h3>
<div class="bg-success description">
  <%= @question.output_description %>
</div>

<div name="samples">
  <h3>入出力例</h3>
  <ul>
    <% @question.samples.each.with_index(1) do |sample, i| %>
        <li><h4>入力<%= i %></h4></li>
        <div class="bg-success">
          <%= sample.input %>
        </div>
        <li><h4>出力<%= i %></h4></li>
        <div class="bg-success">
          <%= sample.output %>
        </div>
        <hr size="3" noshade="noshade">
    <% end %>
  </ul>
</div>
<% if @is_teacher %>
  <%= render "questions/answers" %>
<% else %>
    <!--現在時間と開始時間・終了時間を比較し、時間内かどうかを確認する-->
  <% if (@lesson.lesson_questions.find_by(:question_id => @question.id).start_time.to_time < Time.now) && (Time.now < @lesson.lesson_questions.find_by(:question_id => @question.id).end_time.to_time) %>
    <%= render "questions/upload_form" %>
  <% end %>
<% end %>
<% flash[:previous] = "question" %>
